<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Registration</title>

    <!-- Bootstrap -->
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <style>
        body {
            background: #f7f7f7;
        }
    </style>
</head>

<body class="p-3">

    <div class="container">
        <h2 class="text-center mb-4">Hotel Customer Registration</h2>

        <div id="messageBox"></div>

        <form id="customerForm" class="row g-3">

            <div class="col-md-6">
                <label class="form-label">Full Name</label>
                <input type="text" id="fullName" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label">Phone Number</label>
                <input type="number" id="phone" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label">Email</label>
                <input type="email" id="email" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label">Aadhar Number</label>
                <input type="number" id="aadhar" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label">Check In Date</label>
                <input type="date" id="checkIn" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label">Check Out Date</label>
                <input type="date" id="checkOut" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label">Number of Adults</label>
                <input type="number" id="adults" class="form-control">
            </div>

            <div class="col-12">
                <label class="form-label">Address</label>
                <textarea id="address" class="form-control"></textarea>
            </div>

            <div class="col-12">
                <label class="form-label">Purpose of Visit</label>
                <textarea id="purpose" class="form-control"></textarea>
            </div>

            <div class="col-12 text-center">
                <button type="submit" class="btn btn-primary px-4">Submit</button>
            </div>
        </form>

        <div class="text-center mt-3">
            <a href="view.html" class="btn btn-primary text-light text-decoration-none">View Submissions</a>
        </div>
    </div>

    <script>
        class CustomerFormHandler {

            constructor() {
                this.form = document.getElementById("customerForm");

                if (this.form) {
                    this.form.addEventListener("submit", (e) => {
                        e.preventDefault();
                        this.validateForm();
                    });

                    this.form.addEventListener("input", () => {
                        this.showMessage("");
                    });
                }
            }

            validateForm() {

                let name = document.getElementById("fullName").value.trim();
                let phone = document.getElementById("phone").value.trim();
                let email = document.getElementById("email").value.trim();
                let aadhar = document.getElementById("aadhar").value.trim();
                let address = document.getElementById("address").value.trim();
                let purpose = document.getElementById("purpose").value.trim();
                let checkIn = document.getElementById("checkIn").value;
                let checkOut = document.getElementById("checkOut").value;
                let adults = document.getElementById("adults").value.trim();

                if (name.length < 3)
                    return this.showMessage("Name must be at least 3 characters", "danger");

                if (phone.length !== 10)
                    return this.showMessage("Phone must be 10 digits", "danger");

                let emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(email))
                    return this.showMessage("Invalid email format", "danger");

                if (aadhar.length !== 12)
                    return this.showMessage("Aadhar must be 12 digits", "danger");

                if (address === "")
                    return this.showMessage("Address cannot be empty", "danger");

                if (purpose === "")
                    return this.showMessage("Purpose is required", "danger");

                let today = new Date().toISOString().split("T")[0];

                if (checkIn < today || checkOut < today)
                    return this.showMessage("Dates must be future dates", "danger");

                if (checkOut < checkIn)
                    return this.showMessage("Check-out must be after Check-in", "danger");

                if (adults <= 0)
                    return this.showMessage("Adults must be valid number", "danger");

                let data = {
                    name, phone, email, aadhar,
                    checkIn, checkOut, adults, address, purpose
                };

                this.saveToLocalStorage(data);
                this.showMessage("Form submitted successfully!", "success");
                this.clearForm();
            }

            saveToLocalStorage(data) {
                let arr = JSON.parse(localStorage.getItem("customers")) || [];
                arr.push(data);
                localStorage.setItem("customers", JSON.stringify(arr));
            }

            clearForm() {
                this.form.reset();
            }

            showMessage(msg, type = "info") {
                document.getElementById("messageBox").innerHTML =
                    msg ? `<div class="alert alert-${type}">${msg}</div>` : "";
            }
        }

        new CustomerFormHandler();
    </script>

</body>

</html>
